<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Security policies definition and enforcement utilizing policy control function framework in 5G | Kevin Liu's Playground || Technical || Travel</title><meta name="author" content="Kevin Liu"><meta name="copyright" content="Kevin Liu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="論文導讀_如何透過5G的PCF網路功能框架來實現安全策略定義和執行">
<meta property="og:type" content="article">
<meta property="og:title" content="Security policies definition and enforcement utilizing policy control function framework in 5G">
<meta property="og:url" content="https://leozzmc.github.io/en/posts/de3933f9.html">
<meta property="og:site_name" content="Kevin Liu&#39;s Playground || Technical || Travel">
<meta property="og:description" content="論文導讀_如何透過5G的PCF網路功能框架來實現安全策略定義和執行">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://leozzmc.github.io/en/img/2.png">
<meta property="article:published_time" content="2021-08-31T21:02:34.000Z">
<meta property="article:modified_time" content="2023-07-02T14:13:30.420Z">
<meta property="article:author" content="Kevin Liu">
<meta property="article:tag" content="5G">
<meta property="article:tag" content="Security Policy">
<meta property="article:tag" content="3GPP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://leozzmc.github.io/en/img/2.png"><link rel="shortcut icon" href="/en/img/kevin3.png"><link rel="canonical" href="https://leozzmc.github.io/en/posts/de3933f9.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/en/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-T4SFRRLLZ0"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-T4SFRRLLZ0');
</script><script>const GLOBAL_CONFIG = {
  root: '/en/',
  algolia: undefined,
  localSearch: {"path":"/en/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Security policies definition and enforcement utilizing policy control function framework in 5G',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-02 22:13:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/en/css/style.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/en/img/2.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">28</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">42</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Find Posts</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page child" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/en/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-language"></i><span> Languages:</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://leozzmc.github.io/"><i class="fa-fw fa-c"></i><span> 中文</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.imgur.com/FXfawHh.jpg')"><nav id="nav"><span id="blog-info"><a href="/en/" title="Kevin Liu's Playground || Technical || Travel"><img class="site-icon" src="https://i.imgur.com/P19VCm0.png"/><span class="site-name">Kevin Liu's Playground || Technical || Travel</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Find Posts</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page child" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/en/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-language"></i><span> Languages:</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://leozzmc.github.io/"><i class="fa-fw fa-c"></i><span> 中文</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Security policies definition and enforcement utilizing policy control function framework in 5G</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-08-31T21:02:34.000Z" title="Created 2021-09-01 05:02:34">2021-09-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-07-02T14:13:30.420Z" title="Updated 2023-07-02 22:13:30">2023-07-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/%E8%AB%96%E6%96%87%E5%B0%8E%E8%AE%80/">論文導讀</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Security policies definition and enforcement utilizing policy control function framework in 5G"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><style>
    :root{
    --maincolor: #50fa7b;
    }
   .info{
    padding: 15px;
    margin-bottom: 20px;
    color: #ffffff;
    border: 1px solid transparent;
    border-radius: 10px;
    background-color: #343232;
    border-color: #b8bdb4;
   }
   .special{
        border-bottom: 3px solid var(--maincolor);
        color: inherit;
        text-decoration:none;
   }
   .newbold{
        color: #ffffff;
        font-weight: bold;
        text-decoration:none;
   }
   a{
    color: #337ab7;
    text-decoration: none;
   }
</style>


<h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>本篇討論的是3GPP定義的5G System(5GS)範圍之中的網路安全議題</p>
<h3 id="5G標準制定"><a href="#5G標準制定" class="headerlink" title="5G標準制定"></a>5G標準制定</h3><p>許多組織或會議對於開發5G架構有卓越貢獻，尤其是在安全層面:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- ITU</span><br><span class="line">- ETSI</span><br><span class="line">- IETF</span><br><span class="line">- NGMN</span><br><span class="line">- 5G-PPP</span><br><span class="line">- NIST</span><br><span class="line">- GSMA等等</span><br></pre></td></tr></table></figure>

<p>有些負責在特定infra上像是關鍵基礎設施，其餘則是為特定用例開發安全標準</p>
<blockquote>
<p>S3A Working Group → 定義5G網路 end to end 安全層面</p>
</blockquote>
<h3 id="5GS"><a href="#5GS" class="headerlink" title="5GS"></a>5GS</h3><p>5G System &#x3D; Access Network + Core Network + UE<br>System Arcitecture → Service-Based Architecture → Is composed of multiple NFs<br>SBA架構中，不同的NFs之間的互動可以兩個NF的點對點的參考點來表示<br><strong>SBI(Service-based Interface)</strong> 用來表示一個給定的NF要如何提供或開放一組服務</p>
<p><strong>Policy Control Function(PCF)</strong> 是一個網路功能用以提供統一且一致的框架來定義任何類型的策略，在前幾代行動網路中，PCF僅用於QoS或計費方面的策略制定</p>
<p>5G架構中增加了對於網路資料分析的服務，藉由一個新的NF，NWDAF(Network Data Analytics Services)<br>用於</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 負載級別(Load Level)資訊</span><br><span class="line">2. 服務體驗</span><br><span class="line">3. 網路效能</span><br><span class="line">4. 異常行為</span><br></pre></td></tr></table></figure>

<p><span class="special">PCF可以訂閱與此類資訊相關的網路分析通知，並用於計算或更新策略，但這目前尚未標準化</span><br>新的統一策略控制框架與5G系統以及增強的資料分析實體之間並無建立明顯的連結，而本篇論文的結果可以幫助這三項區域變得更加緊密</p>
<p>主要目標是要找到一個有效的security enforcement schema用以彈性地建立新的安全策略，並動態地回應持續變化地安全環境，橫跨5G end to end 架構。</p>
<p>對於橫跨5G系統地Security Enforcement應在<strong>TSG-SA</strong> 層級被討論</p>
<p>5GS架構中對於User Plane Security Enforcement，會是基於UE與基站之間的air interface其中地機密性與完整性演算法是否啟用</p>
<p>對於UP的完整性保護演算法是可以選擇性啟用的(例如各切片可以是否啟用)</p>
<h3 id="網路切片"><a href="#網路切片" class="headerlink" title="網路切片"></a>網路切片</h3><p><span class="special">個別網路切片提供不同種服務可能會有著不同的安全需求，並採用不同安全協定與方法；因此對於不同的網路切片提供不同層級的安全防護會是關鍵</span></p>
<p>對於安全加密演算法的使用也是選擇性的(e.g. 128bits vs 256 bits key length)<br>像是對於關鍵基礎設施的安全需求以及enhanced Mobile Broadband 大量使用場景的安全需求也有所不同</p>
<p>將 QoS 原則應用於安全，目標應是利用統一的策略控制框架，並利用新的資料分析功能作為對於網路以及UE知識基礎，在 5G end to end 架構中實現有效的安全策略定義和執行</p>
<p>現行對於電信網路的保護策略不外乎防火牆、IDS、DDOS保護系統等等，並被廠商的特定管理工具所管理<br>而這些安全功能是為了保護整個網路或根據他們在網路中的定位，而未考慮個別UE</p>
<ol>
<li>偵測到單一UE發生安全問題的能力</li>
<li>應用解決措施到單一UE的方式到目前都是個問題</li>
</ol>
<p>本篇研究補足了這些機制，並從end to end網絡的角度豐富了安全性，並提共適當的粒度(granularity) 來考慮個別UE的安全策略<br>→對於 uRLLC 以及 mMTC 部屬場景有幫助</p>
<p><img src="https://i.imgur.com/BOTV0hU.png"></p>
<h2 id="2-Challenges-to-apply-end-to-end-security-enforcement-in-5G"><a href="#2-Challenges-to-apply-end-to-end-security-enforcement-in-5G" class="headerlink" title="2. Challenges to apply end to end security enforcement in 5G"></a>2. Challenges to apply end to end security enforcement in 5G</h2><p>為了實踐end to end security enforcement，有四大挑戰要解決</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- 為Security Enforcement應用QoS原則</span><br><span class="line">- 會話管理和用戶平面</span><br><span class="line">- 策略控制</span><br><span class="line">- 網路分析</span><br></pre></td></tr></table></figure>

<h3 id="2-1-Challenges-to-apply-QoS-principles-to-security-enforcement"><a href="#2-1-Challenges-to-apply-QoS-principles-to-security-enforcement" class="headerlink" title="2.1 Challenges to apply QoS principles to security enforcement"></a>2.1 Challenges to apply QoS principles to security enforcement</h3><p>當根據業務需求（例如在垂直市場中產生）將 QoS 實施基本原則應用於安全實施時，主要困難之一是能夠以與 QoS 在網絡中量化的類似方式來衡量安全特性</p>
<p>QoS 配置文件被很好地定義為應用於 QoS 流的一組 QoS 參數（QoS 流是分組數據單元 (PDU) 會話中 QoS 區分的最細粒度）。這種參數化是定量的，即可以用數字來衡量。例如，5G QoS 標識符是一個由標量表示的參數，用作 5G QoS 特性（如調度、權重、准入閾值等）的參考。甚至還有預先配置的標準化值。但是，如何在 5G 架構中構建安全配置文件，如何建立完整性保護、機密性保護、訪問控製或惡意軟件檢測等方面的量化安全參數化？我們解決這個問題的提議在第 3.1 節中提出。</p>
<h3 id="2-2-Challenges-at-session-management-level-to-enforce-security-controls"><a href="#2-2-Challenges-at-session-management-level-to-enforce-security-controls" class="headerlink" title="2.2  Challenges at session management level to enforce security controls"></a>2.2  Challenges at session management level to enforce security controls</h3><p>SMF負責接收由UE所發送來的建立PDU Session的請求<br>然而現今的PDU 請求並沒有包含任何安全參數</p>
<p>所以UE請求<strong>特定的</strong> 5G UP安全服務，即”安全的PDU”，是不可能的<br>然後像是政府關鍵基礎設施可能就有需求是，應提供特殊安全措施在UE與Data Networl之間的PDU Session<br>例如某些<strong>資料無線電承載(Data Radio Bearer)</strong> 支援某些服務中的強加密演算法或更長的加密金鑰</p>
<p>SMF在建立PDU會話時，根據來自</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- UDM的Subscriber資訊</span><br><span class="line">- 每個DNN/SMF中切片的本地配置UP安全策略</span><br><span class="line">- 每個UE所支援的最高Data Rate</span><br></pre></td></tr></table></figure>
<p>用以在PDU Session建立UP Security Enforcement 來在每個DRB中提供完整性保護<br>SMF的本地配置被認為是全局適用(global applicable)的靜態策略</p>
<p>問題是這種靜態方法對於之後的的用例是否仍然有效，其中訂閱計劃可能與安全增值服務和相應的租戶（例如關鍵基礎設施的所有者）需要不同級別的安全（例如每個切片）和對安全事件作出反應的能力</p>
<p>這些use case需要彈性、可擴展和動態的策略管理以及設定<br>此外，security enforcement只是指示是否要在NG-RAN網路區域應用UP完整性與機密性保護，並僅適用於3GPP類型的存取</p>
<p>UP Security Enforcement 從NG-RAN擴展到傳輸以及核網會是個挑戰<br>(即PDU會話提供的整體連接的end to end security enforcement方法 會是個挑戰)</p>
<p><img src="https://i.imgur.com/7xtxVnm.png"><br>圖2顯示了當前UP security enforcement以及注意事項</p>
<p><img src="https://i.imgur.com/JwXF00a.png"></p>
<p>一旦PDU Session建立，<br>當前Session的特徵(即PDU會話資訊)僅限於一些主要與QoS相關的資訊元素(例如:QoS Flow ID,Reflective QoS Indicator)<br>當發生了PDU層級的安全事件，並沒有觸發緩解措施的安全屬性<br>例如，當應用程式處理被歸類為機密的資料時在UE與Data Network之間的PDU Session內會需要特別的安全措施，像是DRB所支援服務中所使用的強加密演算法或更長的加密金鑰</p>
<blockquote>
<p>在 3.25章節開發了一個框架，為PDU層級的安全事件提供安全屬性</p>
</blockquote>
<h3 id="2-3-Challenges-to-fine-security-policies-under-policy-control-framework"><a href="#2-3-Challenges-to-fine-security-policies-under-policy-control-framework" class="headerlink" title="2.3 Challenges to fine security policies under policy control framework"></a>2.3 Challenges to fine security policies under policy control framework</h3><p>雖然為每個訂閱定義安全策略很費力，但這與為QoS進行此操作似乎沒甚麼不同<br>可以預期，安全策略與QoS測並非真正獨立，而是相同策略可被應用在大量訂閱 e.g.per slice</p>
<p><strong>Policy and Charging Control rule (PCC rule)</strong> 包含啟用用戶面偵測、策略控制、對於服務資料流的適當計費所需的資訊</p>
<p>兩種PCC rules存在:動態與預定義規則<br>動態規則由PCF提供給SMF，而預定義PCC規則則是被設定至SMF</p>
<p>當動態規則與預先定義的PCC規則有相同優先級，則動態規則優先<br>這些policies的目標是:</p>
<ul>
<li>PDU sessions</li>
<li>Service Data Flows (SDF). Set of PDUs (within PDU session) identidied by traffic filters</li>
</ul>
<p>PCF Control是否應用於PDU Session是由SMF策略基於DNN或每個切片去定義的<br>若沒有PCF Cnotrol，則本地基於策略的rule會在SMF被設定</p>
<p>PCC rule 定義包含:</p>
<ul>
<li>Sevice data flow detection mechanism  (ex. filters, application template)</li>
<li>Charging releated Information Elements(IEs) </li>
<li>Policy control related IEs  (ex. Gating, QoS, bit rates…etc)</li>
</ul>
<p>service data flow filter 包含用於匹配IP PDU流量以及Ethernet PDU流量的用戶平面資料<br>SMF應用啟用的PCC規則內的Service data flow template information來指示UPF去識別屬於特定<br>service flow的封包</p>
<p><span class="special">作為一個PCC規則一部分的安全資訊元素的適當定義會是一個關鍵挑戰</span></p>
<p>目前 <strong>3GPP TS 23.503: Technical Specification Policy and Charging Control Frameworkfor the 5G System</strong> 所定義的PCC Rules不明確包含此類參數，也不作為能夠識別安全事件的服務資料流偵測的一部分，或者做為策略控制操作的一部分。 此外，SMF發送有關PDU Session狀態(e.g. 存取類型、漫遊、IP位址等等)的PCF資訊，因此PCF可以基於特定觸發器做出動態反應從而相應變更策略，所以安全觸發器的定義非常重要，因為它不僅會影響網絡的安全狀態，還會影響網絡的整體 QoS 和 SLA（例如 DDoS 攻擊），然而去創造這些安全觸發器(例如，最近發現的安全漏洞、詐欺、攻擊、違規存取等等)會是挑戰，在UPF或其他特定安全探測器(security probe)中設定一部分偵測過濾器(detection filter)，其策略目標是將安全保證(security assurance)層面包含進網路整體的服務保證中。</p>
<p><span class="special">⚠️目前問題則是，如何使安全性成為 PCF 的 PCC 決策過程的一部分？</span><br>本篇論文在3.3章節提供解答</p>
<h3 id="2-4-Challenges-to-introduce-security-use-cases-under-network-analytics"><a href="#2-4-Challenges-to-introduce-security-use-cases-under-network-analytics" class="headerlink" title="2.4 Challenges to introduce security use cases under network analytics"></a>2.4 Challenges to introduce security use cases under network analytics</h3><p><strong>Network Data Analytics function (NWADF)</strong> 作為SBA架構出現在Release 15</p>
<p>可以有多個專門用於不同類型分析的 NWDAF，由分析 ID 訊息元素 (IE) 標識。此 IE 用於識別 NWDAF 可以生成的受支持分析的類型。 NWDAF 出於不同目的與不同實體進行交互，例如基於訂閱不同網絡功能提供的事件的數據收集、從數據存儲庫和 NF 檢索訊息，以及向不同類型的消費者按需提供分析，目前NWADF的資料蒐集功能僅允許從控制平面來源為切片或UE獲取資料，但目前如何從UPF蒐集有關用戶平面安全資料尚未標準化，這實際上目前僅限於流量和數據速率。</p>
<p><strong>OAM(Operation,Administration and Management)</strong> 系統僅測量與追蹤資料，這些資料可通過Management Service 共享給NWADF</p>
<p>出於安全分析目的，從用戶平面流量分析中收集的有關惡意軟體、殭屍網絡、協定異常等的資訊，例如通過 [18] 提出的安全探測器（例如嵌入 UPF 中的 IDS）或惡意軟件沙箱，將非常有用通過新的安全用例增強網絡分析。</p>
<p>這些分析資訊環繞網路切片的負載水平、服務體驗、網路效能、移動性、QoS、UE行為等等<br>提供了有價值的知識基礎</p>
<p>本文範圍中有三個基本問題被提出:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- 如何從所分析知識的基礎上取得安全性相關的資訊?</span><br><span class="line">- 在NWADF中可監控和進一步分析哪些特定的新安全參數?</span><br><span class="line">- 在end to end 5G架構中PCF，要如何利用這些資訊來設定並執行安全策略?</span><br></pre></td></tr></table></figure>

<h2 id="3-Proposed-approach-to-security-enforcement-in-5G"><a href="#3-Proposed-approach-to-security-enforcement-in-5G" class="headerlink" title="3. Proposed approach to security enforcement in 5G"></a>3. Proposed approach to security enforcement in 5G</h2><p>從實施角度來看，到目前為止，行動網絡中安全策略和 QoS 參數的實現在網絡中存在很大差異</p>
<p>5G PCF是一個單一框架用來定義任何類型的策略並將其遞交給其他控制平面上的NF</p>
<p>從不久的將來角度來看，當租戶要求的訂閱計畫(Subscription Plan)將需要包含安全條款時，即安全性作為SLA的重要組成部分，就像當今的QoS一樣，我們提出了新的security enforcement方式利用了統一策略控制模型</p>
<h3 id="3-1-Application-of-QoS-policies-to-security-use-cases"><a href="#3-1-Application-of-QoS-policies-to-security-use-cases" class="headerlink" title="3.1 Application of QoS policies to security use cases"></a>3.1 Application of QoS policies to security use cases</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- session-AMBR</span><br><span class="line">- UE-AMBR</span><br></pre></td></tr></table></figure>

<p>我們的提案是，這些 QoS 策略可以在接收安全事件或事件時從 PCF 受限制地和動態地應用到網絡中，這些安全事件可以在 NWDAF 或用戶平面的其他安全分析平台（例如，放置在管理平面中的 SIEM 工具，嵌入在 UPF 中的 IDS 系統等）中建立</p>
<p>基於預定義的安全指標，可以從 PCF 執行不同的策略，實際上作為網絡中的有效緩解機制：</p>
<ul>
<li>設定新的session AMBR</li>
<li>設定新的UE AMBR，這將會是一種對於UE的隔離 (例如，UE是作為DDoS攻擊的active bot)</li>
<li>在QoS Profile內使用更嚴格的安全控制以設定新的PDU Session</li>
</ul>
<p>QoS profiles 可在5G AN中由SMF動態建立；可以透過來自SMF的N1介面上的會話管理信令或直接在N4介面上的UPF上對UE實施特定的QoS規則</p>
<p>N1介面: UE $\leftrightarrow$ AMF<br>N4介面: SMF $\leftrightarrow$ UPF 用以在用戶平面中管理資料會話<br>N4基於PFCP協定(Packet Forwarding Control Protocol)</p>
<p>SMF 確實通過規則管理 QoS 流，將流量過濾器與來自 PCF 的 QoS 策略相關聯。<br>流量過濾器集在 UPF 中配置，可用於輕鬆管理安全服務。例如：</p>
<ul>
<li>由具有特殊安全要求（例如加密演算法、密鑰長度等）的特定一組UE或切片的特定安全參數index標識出的安全關聯</li>
<li>像是交通控制之類的偵測與動態QoS 規則可以被動態應用</li>
</ul>
<p>下面流程圖描繪了應用安全規則作為在網路中QoS策略的一部分概念:<br><img src="https://i.imgur.com/3514RyB.png"></p>
<p>下圖為透過以上概念實現的安全呼叫步驟<br><img src="https://i.imgur.com/1t07hXz.png"></p>
<p><em>1.a</em> <span class="special"><strong>NWDAF → PCF</strong></span><br>PCF訂閱了NWDAF通知<br>由於網路安全事件(ex. DDoS)，我們發現了使用者資料擁塞的情況，該情況透過N23介面傳送給了PCF</p>
<p><em>1.b</em> <span class="special"><strong>Security Management → PCF</strong></span><br>安全管理系統通過REST API與PCF整合而成<br>安全事件被報告給PCF</p>
<p><em>1.c</em> <span class="special"><strong>PCF → UDR(optional)</strong></span><br>PCF藉由N36介面向UDR請求一組資料<br>在此用例中，請求資料可以是訂閱策略集的安全策略部分的ID，以在發生安全事件時應用。</p>
<p><em>2.</em> <span class="special"><strong>PCF → SMF</strong></span><br>當PCF做出策略決定後，PCF則確定SMF需要更新策略資訊以緩解安全問題，並藉由N7介面發送一個<br><strong>Npcf_SMPolicyControl_UpdateNotify</strong> 請求其中包含關於PDU Session的更新策略資訊，在這種情況下建立新的 Session AMBR</p>
<p><em>3.</em> <span class="special"><strong>SMF → PCF</strong></span><br>SMF回應PCF一個ACK</p>
<p><em>4.a</em> <span class="special"><strong>SMF → UPF</strong></span><br>基於SMF所發送的QoS Emforcement Rule的QoS enforcement是一個由UPF提供的功能<br>包含通過N4介面對Session AMBR (Step2 從SMF接收來自PCF)</p>
<p><em>4.b</em> <span class="special"><strong>SMF → UE</strong></span><br>藉由AMF與UE交換N1 SM信令，來提供UE QoS規則<br>e.g. 設定新的UE-AMBR 來限制在UE所有PDU Session中所有Non-GBR QoS Flow所被預期可提供的最高Bit rate</p>
<p><em>4.c</em>  <span class="special"><strong>SMF → 5G AN</strong></span><br>藉由AMF與5G-RAN交換N2 SM信令，以設定5G RAN的QoS參數<br>e.g. 為特定類型的流量預留資源</p>
<h3 id="3-2-User-plane-security-enforcement-and-assurance"><a href="#3-2-User-plane-security-enforcement-and-assurance" class="headerlink" title="3.2. User plane security enforcement and assurance"></a>3.2. User plane security enforcement and assurance</h3><p>在UP 流量上實現安全策略的方式是一樣是基於策略控制</p>
<p>直接作用於AMF、SMF等控制NF，而PCF應到達UE、RAN和UPF以直接在UP上應用這些策略</p>
<h4 id="3-2-1-Security-policies-enforcement-via-AMF"><a href="#3-2-1-Security-policies-enforcement-via-AMF" class="headerlink" title="3.2.1. Security policies enforcement via AMF"></a>3.2.1. Security policies enforcement via AMF</h4><p><img src="https://i.imgur.com/MfoI2Au.png"></p>
<p>有兩種類別的策略是為了<strong>存取</strong>與<strong>移動性管理</strong><br>它們被AMF執行、由PCF規定並儲存在UDR中<br>它們可以支持安全用例，而無需對策略定義進行重大更改：</p>
<ul>
<li><p>Policies transfered from PCF to AMF:</p>
<ul>
<li>Service area restrications<br>  <strong>Tracking Area</strong> 是一種區域上的邏輯概念，使用者可在其中移動而無須更新管理節點，網路會分配一個或多個TAs到使用者上<br>  而Service area restrication包含<strong>允許區域</strong>與<strong>非允許區域</strong><br>  本篇論文提出，使用特定閥值為不同服務區域建立安全等級，來決定使用者是否有權移動到高安全服務區域<br>  舉例: 地理上的敏感地區，像是關鍵基礎設施可能會限制對使用 <strong>“Null Schema”</strong> 來產生SUCI的使用者的存取，以防止像是惡意基地台的影響，換句話說可能會允許支援UP完整性保護的使用者存取<br>  <img src="https://i.imgur.com/EXWGDgX.png"></li>
<li>Priorities of area types the user may use<br>  適當的優先權定義可避免<strong>降級攻擊</strong>，迫使UE連接到更多脆弱性的網路(像是2G)，比起4G、5G網路來說更容易遭受攻擊，攻擊者可以通過使 UE 和網絡實體分別相信對方不支持安全功能來嘗試降級攻擊，即使雙方實際上都支持該安全功能<br>  <img src="https://i.imgur.com/8nbzQWr.png"><br>  <strong>Anti-Bidding down Architecture</strong> 在Release 15中已經定義，但目前並為真正生效，因為它的目的是在於防止從未來的增強安全功能降低到當前的安全功能<br>  <img src="https://i.imgur.com/PC8zo8N.png"></li>
</ul>
</li>
<li><p>Policies transferred from PCF to the UE via AMF</p>
<ul>
<li>User Equipment Route Selection Policy to determine how to route egress traffic(PDU selection policies)<br>  當安全事件發生時可能會觸發新的PDU Session(e.g. 在UE中的惡意程式偵測)i.e.<br>  一種在data path上具有特殊策略的<strong>隔離</strong> PDU，甚至是在具有特殊安全服務的安全DN中終止的PDU</li>
</ul>
</li>
</ul>
<p><span class="special">LADN(Local Area Data Network)的概念在5G中用於支援MEC，並支援上述措施的實踐。LADN對僅授權在某一組位置(被稱為<strong>LADN Services Areas</strong>)中的PDU Session中實施限制。</span></p>
<p><span class="special">LADN services Areas 在AMF中基於每個DNN去進行設定，而AMF會提供UE LADN Service Areas的資訊</span></p>
<h4 id="3-2-2-Security-policies-enforcement-via-SMF"><a href="#3-2-2-Security-policies-enforcement-via-SMF" class="headerlink" title="3.2.2. Security policies enforcement via SMF"></a>3.2.2. Security policies enforcement via SMF</h4><blockquote>
<p>SMF 功能介紹 : SMF負責控制一個PDU Session所需的信令(通過N4信令)，並設定這個PDU Session中的用戶平面處理(支援PDU Session的用戶平面功能(UPF)的選擇)</p>
</blockquote>
<p>因此SMF控制了UPF所支援的功能，包含安全相關的功能像是，防火牆、節省流量、DDoS保護、GPRS Tunneling Protocol(GTP)、(新的Inter PLMN UP Security in Release16)等等功能</p>
<p>此外它還控制策略執行(policies enforcement)，即與PCF互動來獲得策略，並將其直接應用到UPF(via N4)或藉由AMF應用到NG-RAN網路中的其他部分.</p>
<blockquote>
<p>Proposal: 提議是被嵌入到UPF的安全控制可通過PCF中的安全策略進行管理</p>
</blockquote>
<p>此外，這個新概念將使air interface中的用戶平面安全實施策略（機密性和完整性保護）在 PCF 中管理（而不是像今天一樣在 SMF 中本地配置），而它們是來自UDR(作為具有預定義安全策略的策略設定文件的儲存)</p>
<p>因此，這些策略應要是專用於用戶平面安全的Dynamic PCC rules的一部分，並可能擴展到其他的domain或UP介面，像是:<br>N6: UPF $\leftrightarrow$ Data Network， 基於IP或Ethernet傳輸<br>N3: UPF $\leftrightarrow$ 5G-RAN，基於GTPv1-U(GPRS Tunneling Protocol User Plane)<br>N9: UPF $\leftrightarrow$ UPF，用以傳輸用戶平面資料，基於GTPv1-U</p>
<h4 id="3-2-3-UP-security-enforcement-use-cases"><a href="#3-2-3-UP-security-enforcement-use-cases" class="headerlink" title="3.2.3. UP security enforcement use cases"></a>3.2.3. UP security enforcement use cases</h4><p>用於 5G 概念的 N6-LAN 應允許 PCF 設定 UPF 以實現安全服務功能鏈到數據網絡<br><img src="https://i.imgur.com/ZkrVdFk.png"></p>
<blockquote>
<p> N3 介面保護機制:  TS33.501 表明在N3(UPF $\leftrightarrow$ RAN)進行資料傳輸應具備機密性、完整性、重放攻擊保護。所需機制是IPSec ESP和 IKEv2 基於憑證的授權機制，然而使用哪種密碼學機制來保護N3是取決於營運商的決定</p>
</blockquote>
<p>在不久的將來，可以根據提供給一組用戶、切片和&#x2F;或租戶的安全級別選擇性地部署這些類型的解決方案，具體取決於服務或基礎設施的要求和重要性</p>
<p>舉例來說:<br>例如，服務於關鍵基礎設施（例如公用事業）的專用網絡，或車載自組織網絡（VANET），當然需要對無線基地台和核網之間的通訊進行全面保護</p>
<blockquote>
<p>Proposal :  本篇論文的提議是；將用於N3的加密解決方案包含進PCC規則中，並強制執行於gNB(via AMF)和UPF系統中的安全閘道器之中(via SMF)強制執行應建立新的IPSec Tunnel或將 PDU 分配給現有的 IPSec Tunnel</p>
</blockquote>
<p>同樣的概念也可應用於N9上一些用例所使用的安全方式，像是不同營運商之間互相連接。這種情況下 GTP檢查以及IPSec已被標準化，但不是作為一個”安全的SLA”的一部分通過PCF執行的，此外，通過新的分析功能（如 NWDAF）或資料庫（如UDSF,Unstructed Data Storage Function）來儲存session資料或從 UPF 或其他特定安全分析平台（可以關聯來自多個來源的事件）接收的安全事件，PCF 可以對查詢 UDR 的既定安全服務級別協議(Security SLA,SSLA)中的更改做出反應，應用新的安全策略，強制建立新的更安全的 PDU，即緩解觸發操作的安全問題</p>
<p><img src="https://i.imgur.com/8ZkUC6D.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Ex:</span><br><span class="line">在某個區域網絡中檢測到假基站</span><br><span class="line">或者簡單地從安全的角度來看某個關鍵區域（例如機場、關鍵基礎設施站點等），</span><br><span class="line">PCF 將對該網絡地理區域中的基站所附的相關 UE/UE 組實施完整性保護。其他約束也可以構建有效的用例（例如，連接到關鍵切片的 UE）。 UE 的策略應從“不需要”更新為“首選”或“需要”</span><br></pre></td></tr></table></figure>


<p>下圖為PDU Session 建立的流程，以粗體顯示本論文要執行call<br>以提供所描述的來自 PCF 的安全策略的動態實施</p>
<p><img src="https://i.imgur.com/pFT8Zpv.png"></p>
<h3 id="3-2-4-Security-assurance"><a href="#3-2-4-Security-assurance" class="headerlink" title="3.2.4. Security assurance"></a>3.2.4. Security assurance</h3><p>一旦使用安全屬性（例如特定服務流的加密、完整性保護、訪問控制策略等）建立 PDU 會話，允許在網絡中進行擴展意義上的安全實施，仍有兩個關鍵方面值得關注可以考慮，即安全資料收集和cloased-loop automation，為了介紹它們，使用了Chargin Function(CHF)做為類比</p>
<p><img src="https://i.imgur.com/SAtlROD.png"></p>
<p>使用資料收集可用於計費、收集統計數據和監控整體網絡使用情況和 UE 行為。<br>當使用者超出某些閥值後(ex.花費額度限制)CHF會告知PCF，而PCF會將此考慮進動態應用相關策略至user session e.g. 給定PDU Session的QoS限制、重新導向到營運商網頁等等</p>
<blockquote>
<p>Proposal: 使用來自UPF中的嵌入式安全功能的安全相關資料來增強&#x2F;豐富資料收集</p>
</blockquote>
<p>SMF負責從UPF收集增強&#x2F;豐富資料並傳送到<strong>中央安全管理系統</strong> (儲存資料，並將其與網路中各種安全專用平台所蒐集的安全資訊做相互關聯) e.g. 防火牆log、Security telemetry、IDS Log等等</p>
<p>安全管理系統要負責創造安全事件，並在 PCF 和&#x2F;或 SMF 上觸發操作<br>e.g. 通知 PCF 某些安全 SLA 已被越過，將用戶流量重新導向到例如清理中心或專用安全 DN 等。</p>
<p>在 5G 中 UPF 在 4G Evolved Packet Core 中承擔流量檢測功能的角色，即封包檢測（例如基於業務數據流的應用檢測），因此它可以執行 PCF 策略。事實上，實現 UPF 的技術集成了越來越多的安全功能，如防火牆或運營商級網絡地址轉換。</p>
<p>5G 核心允許 PCF 在發送到 UE 的連接相關策略和發送到網絡的策略之間進行協調，這些策略可以部署在用戶平面的 UPF 中，例如嵌入在 UPF 中的 L7 防火牆中的安全策略，用於針對特定用戶的特定服務。以下兩個用例說明了這個概念：</p>
<h3 id="use-case1"><a href="#use-case1" class="headerlink" title="use case1"></a>use case1</h3><p>根據3GPP TS 23.503，PCF支援的用於PDU Session的SMF 選擇管理(Selection Management)的功能之一是，向AMF提供策略以通知PCF去針對特定DNN執行DNN replacement，此類replacement操作的觸發器，可能是由於安全事件而受損的DNN，由於特定DN或切片過載(ex. DDoS)，而通過NWADF報告給PCF</p>
<h3 id="use-case2"><a href="#use-case2" class="headerlink" title="use case2"></a>use case2</h3><p>當 SMF 收到 PCC 規則時，SMF 可以採取措施重新設定 PDU 的 UP。這些行動之一可以是使用新的指導規則來更新UPF，例如將某些可疑流量轉發到本地資料中心(Ex. MEC)，目的是在網路中的小型受控區域內遏制潛在的安全漏洞</p>
<p>MEC 的概念是促進 UPF 在網絡邊緣的部署，更靠近 UE，有時用於關鍵應用程序<br>e.g. Ultra Low Level latency use case、快取、體育場館等</p>
<p>作為對事件的響應(response)，應用功能(Application Function,AF)可以向5G核網(i.e PCF or via Network Exposure Function(NEF))發出請求，已將一組UE甚至整個切片的流量引導至位於邊緣的UPF，可以部署 DDoS 保護、清洗中心、IDS&#x2F;IPS 等安全功能作為遏制機制。</p>
<blockquote>
<p>AF功能: AFs與3GPP 核網互動，以提供服務:像是應用程式對流量路由的影響、存取NEF、與策略框架互動(藉由N5)等等 i.e. 它請求動態策略<br>如今，AF 作為 MEC 調度應用程式或 IP Multimedia System (IMS)。</p>
</blockquote>
<blockquote>
<p>Proposal: 將 AF 的範圍擴展到安全應用：</p>
</blockquote>
<ul>
<li>對於流量路由(traffic routing)的影響作為安全緩解機制<br>舉例:測到攻擊（例如 DDoS）時的 BGP Injection 和路由變更</li>
<li>藉由NEF存取5G核網<br>舉例:提供威脅情報源的第三方安全公司</li>
<li>與策略框架的互動<br>舉例: 由於不可預測的安全事件或由於新的威脅簽名而提供新的 SDF 過濾規則的策略變更</li>
</ul>
<h3 id="3-3-Establishing-security-policies-as-part-of-PCC-rules"><a href="#3-3-Establishing-security-policies-as-part-of-PCC-rules" class="headerlink" title="3.3. Establishing security policies as part of PCC rules"></a>3.3. Establishing security policies as part of PCC rules</h3><p>PCC規則將 <strong>SDF模板</strong>(服務資料filter的列表或應用程式filter的應用程式ID)<br>以及對流量的可能操作(策略實施)連接起來</p>
<p>以 3GPP 提出的當前行動為基礎，專注於純粹的QoS actions，我們建議出於安全目的擴展和應用這些actions，並歸納成表 1</p>
<p><img src="https://i.imgur.com/gXZeTff.png"></p>
<p>3GPP TS 23.503的6.3.1表格列出了PCC規則中包含的資訊，像是資訊名稱(information name)<br>、描述(description)、以及PCC是否可在SMF內被啟用的Dynamic PCC規則之中修改此資訊</p>
<p>表2 顯示 TS 23.503的6.3.1表格的摘錄<br><img src="https://i.imgur.com/a7jUM1v.png"><br>表格中的灰色區域顯示了在原標準上增添的元素</p>
<p>在”Security”類別中，有兩項Information Elements，這兩項元素涉及目前在用戶平面中存在的安全策略，但目前僅在SMF中進行本地管理且僅限於Access Network(AN)<br>我們的貢獻是使它們成為 PCC 規則結構的一部分：</p>
<ul>
<li><p>以PDU的層級來看，PCF 還可以控制 PDU Session的不同參數，其中包括 SMF 從 PDU Session中獲取新策略的條件（策略控制請求的觸發器），而這些條件對於定義安全用例十分重要 i.e.<br>若這些條件是安全觸發器(e.g.意外事件、過載、超出閥值等)，則PCC 安全規則將從 PCF 傳達到 SMF，並在 UPF 和&#x2F;或 5G-RAN中執行。</p>
</li>
<li><p>PDU Session相關策略資訊的目的是提供分別適用於單個監控金鑰匙或整個PDU Session的PCC(Policy and charging control)，PCF 可以將 PDU 會話相關的策略訊息與 PCC 規則一起或單獨提供給 SMF</p>
</li>
</ul>
<p>TS 23.503的6.4-1表格包含了PDU Session相關的策略資訊<br>表3 顯示 TS 23.503的6.4-1表格的摘錄，重點關注使用監控控制相關訊息，其中提出了兩個新的監控密鑰用於 (D)DoS 攻擊檢測。<br><img src="https://i.imgur.com/B6DC660.png"></p>
<p><span class="special">最後，PCF 還應指示 SMF 檢測哪些應用程序。在收到來自 SMF 的報告後，PCF 可以做出策略決定並向 SMF 發送更新的或新的 PCC 規則。如果網絡中的特定安全分析能夠定義攻擊，則應將相同的過程應用於安全 (e.g. 在bot 與 C&amp;C中心之間的通訊)或特徵化安全事件概況 (e.g. 意圖在通訊中使用指定協議的無效port來破壞存取控制防火牆規則 )</span><br>因此，可以像任何其他應用程序簽名一樣創建安全簽名，並應用相應的 PCC 規則。</p>
<h3 id="3-4-Security-analytics-implemented-in-NWDAF"><a href="#3-4-Security-analytics-implemented-in-NWDAF" class="headerlink" title="3.4. Security analytics implemented in NWDAF"></a>3.4. Security analytics implemented in NWDAF</h3><p><img src="https://i.imgur.com/pp10sLI.png"></p>
<p>NWDAF 提供的訊息可以對 PCF 執行的 PCC 決策過程做出重大貢獻</p>
<p>然而，分析訊息目前僅限於切片特定的網絡狀態，例如負載級別訊息。即，不需要知道使用切片的訂戶，但它在網絡切片級別工作</p>
<blockquote>
<p>Proposal: 擴展負載級別訊息，添加安全上下文訊息（例如事件、攻擊、漏洞等）</p>
</blockquote>
<p>它需要將單獨實施的安全功能或作為標準化網絡功能的一部分（例如具有嵌入式防火牆功能的 UPF）提供給 NWDAF 或中間專用安全分析平台。</p>
<p>標準 TS 23.288 [11] 為不同類型的 NWDAF 提供了可能性，專門用於不同類型的分析，由Analytics ID Information Element 所標識。</p>
<p>PCF 可以通過 N23 接口使用此訊息。其中一些訊息已經可以為安全分析和進一步實施提供非常有用的訊息，如前幾節所述。</p>
<p>[11] 的表 7.1-2 顯示了 NWDAF 服務提供的分析訊息。我們在此表中添加了一列，其中包含可能被提取到其他安全分析功能以進行進一步分析或直接提取到 PCF 框架以應用特定安全 PCC 規則的安全資訊（參見表 4）。</p>
<p><img src="https://i.imgur.com/URrNthl.png"></p>
<p>安全分析特別有趣的是 NWDAF 捕獲的與異常行為相關的網絡數據分析。</p>
<p>PCF 可以使用 <strong>Nnwdaf_AnalyticsSubscription_Subscribe</strong> 服務操作去訂閱與 “異常行為” 相關的網絡分析通知，目的是預測和檢測安全問題、觸發新的安全策略或更新特定 UE 或 UE 組的現有安全策略。 該封包括Analytics ID（”Abnormal behaviour”）、分析報告目標<strong>SUPI</strong>、<strong>Internal Group ID</strong> 和分析過濾器(filter)，包括異常 ID 列表和每個異常 ID 的可能閾值</p>
<p>前的異常 ID 列表在 [11] 中指定，例如“意外的 UE 位置”、“懷疑 DDoS 攻擊”、“錯誤的目標地址”等。標準的表 6.7.5.3-3 提供了減輕風險的策略和行動示例，例如“擴展服務區限制”、“釋放 PDU 會話”、“更新封包過濾器&#x2F;QoS”等。</p>
<p>如本文檔第 2.4 節所述，挑戰在於，在用戶平面級別，每個應用程序的通信描述僅限於該通信的流量和數據速率，與體積類型的攻擊（例如氾濫、過載、DoS 等）。</p>
<p>統計或預測中的變化或異常，例如 UE 通信的周期、通信持續時間或某些流量特徵（例如異常端口、可疑 DNN、其他有用訊息等）、上傳&#x2F;下載量（平均值和方差） ) 可能表示安全事件或事故。</p>
<p>在用戶平面層面，新提案包括，除了數量、變化和異常之外，NWDAF 可以直接從 UPF 收集真實的安全事件（事實），這要歸功於附加或嵌入其中的用戶平面安全檢查功能。此安全訊息可能會被 PCF 等活動 NF 使用，以動態更新 UE 組中特定 UE 的 PCC 規則、更改 PDU 或什至在需要時在切片級別採取行動</p>
<h2 id="4-Future-work"><a href="#4-Future-work" class="headerlink" title="4. Future work"></a>4. Future work</h2><p>基於本論文提出的Security Enforcement的原則，有三個領域可以進一步去研究</p>
<ul>
<li>specific security analytics supported by machine learning algorithms</li>
<li>roaming scenarios, including local break out</li>
<li>applicability to IoT use cases</li>
</ul>
<h2 id="5-Conclusion"><a href="#5-Conclusion" class="headerlink" title="5. Conclusion"></a>5. Conclusion</h2><p><img src="https://i.imgur.com/VkTuInH.png"></p>
<h2 id="參考資源"><a href="#參考資源" class="headerlink" title="參考資源"></a>參考資源</h2><p><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0140366421001262">https://www.sciencedirect.com/science/article/pii/S0140366421001262</a></p>
<p>meeting簡報: <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1RK6R5yjRuvS-BhdTjZPhOXAg9ghlW2O6/view?usp=sharing">https://drive.google.com/file/d/1RK6R5yjRuvS-BhdTjZPhOXAg9ghlW2O6/view?usp=sharing</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://leozzmc.github.io/en">Kevin Liu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://leozzmc.github.io/en/posts/de3933f9.html">https://leozzmc.github.io/en/posts/de3933f9.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en/tags/5G/">5G</a><a class="post-meta__tags" href="/en/tags/Security-Policy/">Security Policy</a><a class="post-meta__tags" href="/en/tags/3GPP/">3GPP</a></div><div class="post_share"><div class="social-share" data-image="/en/img/2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/en/posts/dd26b396.html" title="🧪筆記-5G開源資源整理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">🧪筆記-5G開源資源整理</div></div></a></div><div class="next-post pull-right"><a href="/en/posts/5728fae1.html" title="📑 DMS_Troubleshooting 筆記"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">📑 DMS_Troubleshooting 筆記</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="utterances-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/en/img/2.png" onerror="this.onerror=null;this.src='/en/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Kevin Liu</div><div class="author-info__description">👍👍👍👍👍</div></div><div class="card-info-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">28</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">42</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/leozzmc"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/leozzmc" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:zzmczzmczzmc870125@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #e0ad5a;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/kevin-liu087" target="_blank" title="LinkedIn"><i class="fa-brands fa-linkedin" style="color: #0373fc;"></i></a><a class="social-icon" href="https://www.youtube.com/channel/UC2AU_vpxPu0oKcgZl3UJSNg" target="_blank" title="Youtube"><i class="fa-brands fa-youtube" style="color: #dc1e1e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">🛫🛬</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Introduction"><span class="toc-number">1.</span> <span class="toc-text">1. Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5G%E6%A8%99%E6%BA%96%E5%88%B6%E5%AE%9A"><span class="toc-number">1.1.</span> <span class="toc-text">5G標準制定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5GS"><span class="toc-number">1.2.</span> <span class="toc-text">5GS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B6%B2%E8%B7%AF%E5%88%87%E7%89%87"><span class="toc-number">1.3.</span> <span class="toc-text">網路切片</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Challenges-to-apply-end-to-end-security-enforcement-in-5G"><span class="toc-number">2.</span> <span class="toc-text">2. Challenges to apply end to end security enforcement in 5G</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Challenges-to-apply-QoS-principles-to-security-enforcement"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 Challenges to apply QoS principles to security enforcement</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Challenges-at-session-management-level-to-enforce-security-controls"><span class="toc-number">2.2.</span> <span class="toc-text">2.2  Challenges at session management level to enforce security controls</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Challenges-to-fine-security-policies-under-policy-control-framework"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 Challenges to fine security policies under policy control framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Challenges-to-introduce-security-use-cases-under-network-analytics"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 Challenges to introduce security use cases under network analytics</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Proposed-approach-to-security-enforcement-in-5G"><span class="toc-number">3.</span> <span class="toc-text">3. Proposed approach to security enforcement in 5G</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Application-of-QoS-policies-to-security-use-cases"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 Application of QoS policies to security use cases</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-User-plane-security-enforcement-and-assurance"><span class="toc-number">3.2.</span> <span class="toc-text">3.2. User plane security enforcement and assurance</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-Security-policies-enforcement-via-AMF"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1. Security policies enforcement via AMF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-Security-policies-enforcement-via-SMF"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2. Security policies enforcement via SMF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-UP-security-enforcement-use-cases"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.2.3. UP security enforcement use cases</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-4-Security-assurance"><span class="toc-number">3.3.</span> <span class="toc-text">3.2.4. Security assurance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#use-case1"><span class="toc-number">3.4.</span> <span class="toc-text">use case1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#use-case2"><span class="toc-number">3.5.</span> <span class="toc-text">use case2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Establishing-security-policies-as-part-of-PCC-rules"><span class="toc-number">3.6.</span> <span class="toc-text">3.3. Establishing security policies as part of PCC rules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-Security-analytics-implemented-in-NWDAF"><span class="toc-number">3.7.</span> <span class="toc-text">3.4. Security analytics implemented in NWDAF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Future-work"><span class="toc-number">4.</span> <span class="toc-text">4. Future work</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Conclusion"><span class="toc-number">5.</span> <span class="toc-text">5. Conclusion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%83%E8%80%83%E8%B3%87%E6%BA%90"><span class="toc-number">6.</span> <span class="toc-text">參考資源</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/en/posts/22f14c54.html" title="【爬山紀錄】七星山主峰 + 東峰"><img src="/en/img/Mountain1.jpg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="【爬山紀錄】七星山主峰 + 東峰"/></a><div class="content"><a class="title" href="/en/posts/22f14c54.html" title="【爬山紀錄】七星山主峰 + 東峰">【爬山紀錄】七星山主峰 + 東峰</a><time datetime="2023-11-19T09:09:43.000Z" title="Created 2023-11-19 17:09:43">2023-11-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/889a40ef.html" title="機群佈建(Fleet Provisioning) - 預先佈建裝置到 AWS IoT"><img src="/en/img/OIG.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="機群佈建(Fleet Provisioning) - 預先佈建裝置到 AWS IoT"/></a><div class="content"><a class="title" href="/en/posts/889a40ef.html" title="機群佈建(Fleet Provisioning) - 預先佈建裝置到 AWS IoT">機群佈建(Fleet Provisioning) - 預先佈建裝置到 AWS IoT</a><time datetime="2023-11-09T07:14:35.000Z" title="Created 2023-11-09 15:14:35">2023-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/aws-iot-device-shadow.html" title="Hands-On Practice: AWS IoT Device Shadow"><img src="/en/img/pepe_shadow.jpg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Hands-On Practice: AWS IoT Device Shadow"/></a><div class="content"><a class="title" href="/en/posts/aws-iot-device-shadow.html" title="Hands-On Practice: AWS IoT Device Shadow">Hands-On Practice: AWS IoT Device Shadow</a><time datetime="2023-11-08T08:30:18.000Z" title="Created 2023-11-08 16:30:18">2023-11-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/efc78ef4.html" title="Hands-On Practice: Amazon SNS Fan out to Amazon SQS"><img src="/en/img/pepe5.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Hands-On Practice: Amazon SNS Fan out to Amazon SQS"/></a><div class="content"><a class="title" href="/en/posts/efc78ef4.html" title="Hands-On Practice: Amazon SNS Fan out to Amazon SQS">Hands-On Practice: Amazon SNS Fan out to Amazon SQS</a><time datetime="2023-10-24T02:18:53.000Z" title="Created 2023-10-24 10:18:53">2023-10-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/e7e295f6.html" title="Hands-On Practice: S3 Gateway Endpoints"><img src="/en/img/pepe4.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Hands-On Practice: S3 Gateway Endpoints"/></a><div class="content"><a class="title" href="/en/posts/e7e295f6.html" title="Hands-On Practice: S3 Gateway Endpoints">Hands-On Practice: S3 Gateway Endpoints</a><time datetime="2023-10-23T04:32:05.000Z" title="Created 2023-10-23 12:32:05">2023-10-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2023 By Kevin Liu</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en/js/utils.js"></script><script src="/en/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'dark'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addModeChange('mermaid', runMermaid)

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>function loadUtterances () {
  let ele = document.createElement('script')
  ele.setAttribute('id', 'utterances_comment')
  ele.setAttribute('src', 'https://utteranc.es/client.js')
  ele.setAttribute('repo', 'leozzmc/Blog_Reply')
  ele.setAttribute('issue-term', 'pathname')
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'photon-dark' : 'github-light'
  ele.setAttribute('theme', nowTheme)
  ele.setAttribute('crossorigin', 'anonymous')
  ele.setAttribute('async', 'true')
  document.getElementById('utterances-wrap').insertAdjacentElement('afterbegin',ele)
}

function utterancesTheme (theme) {
  const iframe = document.querySelector('.utterances-frame')
  if (iframe) {
    const theme = theme === 'dark' ? 'photon-dark' : 'github-light'
    const message = {
      type: 'set-theme',
      theme: theme
    };
    iframe.contentWindow.postMessage(message, 'https://utteranc.es');
  }
}

btf.addModeChange('utterances', utterancesTheme)

if ('Utterances' === 'Utterances' || !false) {
  if (false) btf.loadComment(document.getElementById('utterances-wrap'), loadUtterances)
  else loadUtterances()
} else {
  function loadOtherComment () {
    loadUtterances()
  }
}</script></div><script data-pjax src="/self/btf.js"></script><script data-pjax src="/en/self/btf.js"></script><script id="canvas_nest" defer="defer" color="34,34,34" opacity="0.8" zIndex="-1" count="350" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="👍,👾,💊,🧪,👁️" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/en/js/search/local-search.js"></script></div></div></body></html>