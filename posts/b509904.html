<!DOCTYPE html><html lang="zh-TW" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>橫向擴展ActiveMQ | Kevin Liu's 部落格 || Technical || Travel</title><meta name="author" content="Kevin Liu"><meta name="copyright" content="Kevin Liu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Amazon MQAmzon MQ 上有託管 Active MQ 這個訊息佇列的服務，近期有碰到問題是問說，要怎麼樣在 Amazon MQ 上做 Horizontal Scaling， 首先簡單解釋一下 Vertical Scaling 跟 Horizontal Scaling 的差異。 Scaling意味著擴展，Vertical Scaling著重於單一實體的運算能力增強，所以Vertical">
<meta property="og:type" content="article">
<meta property="og:title" content="橫向擴展ActiveMQ">
<meta property="og:url" content="https://leozzmc.github.io/posts/b509904.html">
<meta property="og:site_name" content="Kevin Liu&#39;s 部落格 || Technical || Travel">
<meta property="og:description" content="Amazon MQAmzon MQ 上有託管 Active MQ 這個訊息佇列的服務，近期有碰到問題是問說，要怎麼樣在 Amazon MQ 上做 Horizontal Scaling， 首先簡單解釋一下 Vertical Scaling 跟 Horizontal Scaling 的差異。 Scaling意味著擴展，Vertical Scaling著重於單一實體的運算能力增強，所以Vertical">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://leozzmc.github.io/img/ActiveMQ/ActiveMQ_Cover.jpeg">
<meta property="article:published_time" content="2023-12-18T20:04:20.000Z">
<meta property="article:modified_time" content="2025-10-26T12:28:30.644Z">
<meta property="article:author" content="Kevin Liu">
<meta property="article:tag" content="AWS">
<meta property="article:tag" content="ActiveMQ">
<meta property="article:tag" content="MQ">
<meta property="article:tag" content="Scaling">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://leozzmc.github.io/img/ActiveMQ/ActiveMQ_Cover.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "橫向擴展ActiveMQ",
  "url": "https://leozzmc.github.io/posts/b509904.html",
  "image": "https://leozzmc.github.io/img/ActiveMQ/ActiveMQ_Cover.jpeg",
  "datePublished": "2023-12-18T20:04:20.000Z",
  "dateModified": "2025-10-26T12:28:30.644Z",
  "author": [
    {
      "@type": "Person",
      "name": "Kevin Liu",
      "url": "https://leozzmc.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/kevin3.png"><link rel="canonical" href="https://leozzmc.github.io/posts/b509904.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-T4SFRRLLZ0"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-T4SFRRLLZ0')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-T4SFRRLLZ0', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"找不到符合您查詢的內容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '複製成功',
    error: '複製失敗',
    noSupport: '瀏覽器不支援'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '剛剛',
    min: '分鐘前',
    hour: '小時前',
    day: '天前',
    month: '個月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '載入更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '橫向擴展ActiveMQ',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg" style="background-color: #f5f1ed;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/me.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">183</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">119</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 找文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 歸檔</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 鏈結</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> 語言:</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://leozzmc.github.io/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/ActiveMQ/ActiveMQ_Cover.jpeg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="https://i.imgur.com/P19VCm0.png" alt="Logo"><span class="site-name">Kevin Liu's 部落格 || Technical || Travel</span></a><a class="nav-page-title" href="/"><span class="site-name">橫向擴展ActiveMQ</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首頁</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜尋</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 找文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 歸檔</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 鏈結</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> 語言:</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://leozzmc.github.io/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">橫向擴展ActiveMQ</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">發表於</span><time class="post-meta-date-created" datetime="2023-12-18T20:04:20.000Z" title="發表於 2023-12-19 04:04:20">2023-12-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新於</span><time class="post-meta-date-updated" datetime="2025-10-26T12:28:30.644Z" title="更新於 2025-10-26 20:28:30">2025-10-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/">學習筆記</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">總字數:</span><span class="word-count">2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">閱讀時間:</span><span>9分鐘</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">瀏覽量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="Amazon-MQ"><a href="#Amazon-MQ" class="headerlink" title="Amazon MQ"></a>Amazon MQ</h2><p>Amzon MQ 上有託管 Active MQ 這個訊息佇列的服務，近期有碰到問題是問說，<strong>要怎麼樣在 Amazon MQ 上做 Horizontal Scaling</strong>，</p>
<p>首先簡單解釋一下 Vertical Scaling 跟 Horizontal Scaling 的差異。</p>
<p>Scaling意味著擴展，Vertical Scaling著重於單一實體的運算能力增強，所以Vertical Scaling可能會是更好的 CPU&#x2F;GPU,更大的記憶體容量等等，</p>
<p>以 AWS 服務來說，可能會是更換實例，MQ的話就會是從 <code>t3.Micro</code> 換成 <code>m5.large</code></p>
<blockquote>
<p>[+] 執行個體類型 - <a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/zh_tw/amazon-mq/latest/developer-guide/broker-instance-types.html">https://docs.aws.amazon.com/zh_tw/amazon-mq/latest/developer-guide/broker-instance-types.html</a></p>
</blockquote>
<p>而若要水平擴展，通常代表架構會接收到更多消息，所以會需要根據流量&#x2F;訊息量來去擴展並且分擔單一實例的負擔。</p>
<h2 id="ActiveMQ-代理網路（Network-of-brokers）"><a href="#ActiveMQ-代理網路（Network-of-brokers）" class="headerlink" title="ActiveMQ 代理網路（Network of brokers）"></a>ActiveMQ 代理網路（Network of brokers）</h2><p>這是一個 ActiveMQ 的原生功能，代理網路包含了多個連接在一起的 Brokers，代理程式之間可共享所代管 client 端以及目標資訊，代理程式之間可以透過網路來路由資訊。</p>
<p>代理程式可以是：</p>
<ul>
<li>Single Instance Broker (節點失敗會無法使用，除非重新啟動)</li>
<li>Active&#x2F;Standby Brokers (網路中有待命模式的 broker，可以共用儲存空間，若Active 節點失敗，則由 Standby 接管)</li>
</ul>
<p>一般來說，若有 Horizontal Scaling的需求，會使用代理網路</p>
<blockquote>
<p>[+] Amazon MQ 代理程式網路 - <a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/zh_tw/amazon-mq/latest/developer-guide/network-of-brokers.html">https://docs.aws.amazon.com/zh_tw/amazon-mq/latest/developer-guide/network-of-brokers.html</a></p>
</blockquote>
<p>下面會逐步帶建構的步驟</p>
<h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><p><img src="/img/ActiveMQ/ActiveMQ1.png"></p>
<p><img src="/img/ActiveMQ/ActiveMQ2.png"></p>
<p><img src="/img/ActiveMQ/ActiveMQ3.png"></p>
<p><img src="/img/ActiveMQ/ActiveMQ4.png"></p>
<p>選擇 <strong>Next</strong></p>
<p><img src="/img/ActiveMQ/ActiveMQ5.png"></p>
<p>這時可以下載 CloudFormation 模板，未來可以方便修改配置重新部署</p>
<p>預估部署所需時間： <strong>25 minutes</strong></p>
<p><img src="/img/ActiveMQ/ActiveMQ6.png"></p>
<p>可以發現三個 Broker 都正在部署中</p>
<p><img src="/img/ActiveMQ/ActiveMQ7.png"></p>
<p>可以點進去 broker 查看詳細的設定配置</p>
<p><img src="/img/ActiveMQ/ActiveMQ8.png"></p>
<p>在設定檔當中可以透過編輯 <code>&lt;networkConnector&gt;&lt;/networkConnector&gt;</code> 當中的屬性進行 MQ 拓墣上的設計</p>
<p>以下是目前建立的 Broker的設定</p>
<ul>
<li>Broker1 上面的 <networkConnectors> 設置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;networkConnectors&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;false&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;QueueConnectorConnectingToBroker2&quot; uri=&quot;masterslave:(ssl://b-88e0e40a-d67a-4476-ac04-9015b4a491e5-1.mq.us-east-1.amazonaws.com:61617,ssl://b-88e0e40a-d67a-4476-ac04-9015b4a491e5-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;topic physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;true&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;TopicConnectorConnectingToBroker2&quot; uri=&quot;masterslave:(ssl://b-88e0e40a-d67a-4476-ac04-9015b4a491e5-1.mq.us-east-1.amazonaws.com:61617,ssl://b-88e0e40a-d67a-4476-ac04-9015b4a491e5-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;queue physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;false&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;QueueConnectorConnectingToBroker3&quot; uri=&quot;masterslave:(ssl://b-52af7fc7-4bb2-4c0d-b427-11a1c965434f-1.mq.us-east-1.amazonaws.com:61617,ssl://b-52af7fc7-4bb2-4c0d-b427-11a1c965434f-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;topic physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;true&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;TopicConnectorConnectingToBroker3&quot; uri=&quot;masterslave:(ssl://b-52af7fc7-4bb2-4c0d-b427-11a1c965434f-1.mq.us-east-1.amazonaws.com:61617,ssl://b-52af7fc7-4bb2-4c0d-b427-11a1c965434f-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;queue physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">  &lt;/networkConnectors&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>Broker2 上面的 <networkConnectors> 設置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;networkConnectors&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;false&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;QueueConnectorConnectingToBroker1&quot; uri=&quot;masterslave:(ssl://b-853601ab-b005-4305-b511-283b560a6ddb-1.mq.us-east-1.amazonaws.com:61617,ssl://b-853601ab-b005-4305-b511-283b560a6ddb-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;topic physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;true&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;TopicConnectorConnectingToBroker1&quot; uri=&quot;masterslave:(ssl://b-853601ab-b005-4305-b511-283b560a6ddb-1.mq.us-east-1.amazonaws.com:61617,ssl://b-853601ab-b005-4305-b511-283b560a6ddb-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;queue physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;false&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;QueueConnectorConnectingToBroker3&quot; uri=&quot;masterslave:(ssl://b-52af7fc7-4bb2-4c0d-b427-11a1c965434f-1.mq.us-east-1.amazonaws.com:61617,ssl://b-52af7fc7-4bb2-4c0d-b427-11a1c965434f-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;topic physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;true&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;TopicConnectorConnectingToBroker3&quot; uri=&quot;masterslave:(ssl://b-52af7fc7-4bb2-4c0d-b427-11a1c965434f-1.mq.us-east-1.amazonaws.com:61617,ssl://b-52af7fc7-4bb2-4c0d-b427-11a1c965434f-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;queue physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">  &lt;/networkConnectors&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>Broker3 上面的 <networkConnectors> 設置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;networkConnectors&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;false&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;QueueConnectorConnectingToBroker1&quot; uri=&quot;masterslave:(ssl://b-853601ab-b005-4305-b511-283b560a6ddb-1.mq.us-east-1.amazonaws.com:61617,ssl://b-853601ab-b005-4305-b511-283b560a6ddb-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;topic physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;true&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;TopicConnectorConnectingToBroker1&quot; uri=&quot;masterslave:(ssl://b-853601ab-b005-4305-b511-283b560a6ddb-1.mq.us-east-1.amazonaws.com:61617,ssl://b-853601ab-b005-4305-b511-283b560a6ddb-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;queue physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;false&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;QueueConnectorConnectingToBroker2&quot; uri=&quot;masterslave:(ssl://b-88e0e40a-d67a-4476-ac04-9015b4a491e5-1.mq.us-east-1.amazonaws.com:61617,ssl://b-88e0e40a-d67a-4476-ac04-9015b4a491e5-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;topic physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">    &lt;networkConnector conduitSubscriptions=&quot;true&quot; consumerTTL=&quot;1&quot; messageTTL=&quot;-1&quot; name=&quot;TopicConnectorConnectingToBroker2&quot; uri=&quot;masterslave:(ssl://b-88e0e40a-d67a-4476-ac04-9015b4a491e5-1.mq.us-east-1.amazonaws.com:61617,ssl://b-88e0e40a-d67a-4476-ac04-9015b4a491e5-2.mq.us-east-1.amazonaws.com:61617)&quot; userName=&quot;Kevin&quot;&gt;</span><br><span class="line">      &lt;excludedDestinations&gt;</span><br><span class="line">        &lt;queue physicalName=&quot;&amp;gt;&quot;/&gt;</span><br><span class="line">      &lt;/excludedDestinations&gt;</span><br><span class="line">    &lt;/networkConnector&gt;</span><br><span class="line">  &lt;/networkConnectors&gt;</span><br></pre></td></tr></table></figure>

<h3 id="conduitSubscriptions-屬性"><a href="#conduitSubscriptions-屬性" class="headerlink" title="conduitSubscriptions 屬性"></a>conduitSubscriptions 屬性</h3><p>根據 ActiveMQ 官方文件 </p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://activemq.apache.org/networks-of-brokers">https://activemq.apache.org/networks-of-brokers</a></p>
</blockquote>
<p><img src="/img/ActiveMQ/ActiveMQ9.png"></p>
<p>訂閱相同目的地的多位消費者被網路視為一個消費者，這是為了避免有收到相同消息的狀況</p>
<p>ActiveMQ 會依賴有關活動消費者（訂閱者）的資訊來在網絡中傳遞訊息，<strong>使用 Conduit Subscription時，如果有多個遠端訂閱，遠程代理將每個消息的副本視為有效，這可能導致訊息重復的狀況產生</strong>。</p>
<p>因此，預設的 Conduit 行為會去<strong>整合所有匹配的訂閱訊息，以防止在網絡中傳播重複</strong>。</p>
<p>這樣，遠程代理上的 <code>N</code> 個訂閱看起來對於網絡代理來說就像是一個單一的訂閱。</p>
<blockquote>
<p>然而，如果只使用 Queue，重複的訂閱是一個有用的功能，因為負載平衡算法將嘗試均勻分配消息負載，僅當 <code>conduitSubscriptions=false</code> 時，跨網絡的消費者才會均勻分享消息負載。</p>
</blockquote>
<p>舉例來說，有兩個代理，A 和 B，它們通過一個 proxy bridge 相互連接。</p>
<p>連接到代理 A 的消費者訂閱一個名為 <code>Q.TEST</code> 的Queue，連接到代理 B 的兩個消費者也訂閱 <code>Q.TEST</code>，所以這裡有三個消費者，並且假設所有消費者具有相等的優先級。</p>
<p>然後，在代理 A 上啟動一個生產者，將 30 條消息寫入 <code>Q.TEST</code>。默認情況下（<code>conduitSubscriptions=true</code>），將有 15 條消息發送到代理 A 上的消費者，其餘的 15 條消息將發送到代理 B 上的兩個消費者。</p>
<p><strong>但也由於預設狀況下，代理 A 將代理 B 上的兩個訂閱視為一個，消息負載並未均勻分佈在所有三個消費者之間。</strong></p>
<p>但如果你將 <code>conduitSubscriptions</code> 設置為 <code>false</code>，那麼三個消費者中的每個將分配到 10 條消息。</p>
<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><p>[+] 執行個體類型 - <a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/zh_tw/amazon-mq/latest/developer-guide/broker-instance-types.html">https://docs.aws.amazon.com/zh_tw/amazon-mq/latest/developer-guide/broker-instance-types.html</a><br>[+] Amazon MQ 代理网络 - 代理网络的工作原理是什么？ - <a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/zh_cn/amazon-mq/latest/developer-guide/network-of-brokers.html#how-does-it-work">https://docs.aws.amazon.com/zh_cn/amazon-mq/latest/developer-guide/network-of-brokers.html#how-does-it-work</a><br>[+]ActiveMQ - NetworkConnectors - <a target="_blank" rel="noopener" href="https://activemq.apache.org/networks-of-brokers">https://activemq.apache.org/networks-of-brokers</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://leozzmc.github.io">Kevin Liu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章連結: </span><span class="post-copyright-info"><a href="https://leozzmc.github.io/posts/b509904.html">https://leozzmc.github.io/posts/b509904.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版權聲明: </span><span class="post-copyright-info">本部落格所有文章除特別聲明外，均採用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 授權協議。轉載請註明來源 <a href="https://leozzmc.github.io" target="_blank">Kevin Liu's 部落格 || Technical || Travel</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/AWS/">AWS</a><a class="post-meta__tags" href="/tags/ActiveMQ/">ActiveMQ</a><a class="post-meta__tags" href="/tags/MQ/">MQ</a><a class="post-meta__tags" href="/tags/Scaling/">Scaling</a></div><div class="post-share"><div class="social-share" data-image="/img/ActiveMQ/ActiveMQ_Cover.jpeg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/613d9ed0.html" title="【學習筆記】OTA Update -1"><img class="cover" src="/img/OTA/OIG.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">【學習筆記】OTA Update -1</div></div><div class="info-2"><div class="info-item-1">什麼是 OTA Update (Over The Air Updtae)?透過無線通訊去對設備進行軟體&#x2F;韌體更新 OTA 的流程 Notify 設備會被通知有擱置的OTA更新 設備可以選擇忽略更新或者接受更新以觸發下載   Download 設備通過各種支援的協定進行更新下載 更新包會下載到預先設定好的儲存區域 Ex. S3 Bucket   更新可能是全新的韌體映像或現有韌體的補丁   Verify 驗證更新包的有效性   Install 設備通過更新包開始更新（通常是通過 bootloader）成最新的韌體 安裝後可以執行檢查以驗證功能 設備將向 OTA 更新提供者報告韌體更新成功    主要分成這四個步驟 模組化 OTA 更新 模組化 OTA 由幾個小型函式庫和一個協調器(Orchestrator)組成。 每個 Lib 負責特定的子任務，例如通知待處理的 OTA 更新或透過 MQTT 下載檔案 編排器將所有小型程式庫與bootloader 和 Memory Pool 同步以執行 OTA 更新。  模組化 OTA 方法可讓您根據需求的變化更換或更改 OTA 的不同部...</div></div></div></a><a class="pagination-related" href="/posts/421a206a.html" title="建立 Lambda 函數 URL 的步驟"><img class="cover" src="/img/AWS/Lambda_URL/cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">建立 Lambda 函數 URL 的步驟</div></div><div class="info-2"><div class="info-item-1">甚麼是 Lambda URL ? 官方定義: 函數 URL 是 Lambda 函數專用的 HTTP(S) 端點。您可以透過 Lambda 主控台或 Lambda API 建立及設定函數 URL。當您建立函數 URL 時，Lambda 會自動為您產生不重複的 URL 端點。函數 URL 一旦建立，其 URL 端點便永遠不會變更。  函數 URL 端點的格式如下： 1https://&lt;url-id&gt;.lambda-url.&lt;region&gt;.on.aws  要特別注意的是，某些region並不支援使用 function URL，這時可能就要用老方法: API Gateway + Lambda Integration 存取控制在建立 function URL 的時候可以透過 AuthType 參數，來決定 Lambda 如何對 funcion URL 的請求執行身分驗證或授權 AuthType 選項:  AWS_IAM : 　如果想讓已完成身分驗證的使用者或Role透過function URL 呼叫你的函數，就要選 AWS_IAM NONE:   Lambda 不...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相關推薦</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/c0ef3a5f.html" title="近一年半的 AWS Cloud Support Engineer 心得記錄"><img class="cover" src="/img/AWS/CSE/aws3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-03</div><div class="info-item-2">近一年半的 AWS Cloud Support Engineer 心得記錄</div></div><div class="info-2"><div class="info-item-1">背景 目前在台灣亞馬遜網路服務公司 (Amazon Web Services) 擔任 雲端支援工程師 (Cloud Support Engineer) ，但兩天後就要離職了，因此想說趁離職前紀錄並回顧一下這一年半以來的工作以及生活。  我是在我碩二上的時候(2021年10月)投遞AWS Cloud Support 校園招聘的職缺，當時原本在找研發替代役，後來因為知道AWS有開缺，抱持著試試看的心情投遞了履歷。大概隔天就收到了Online Assessment 的通知。OA其實就是簡單的電腦基礎知識，應該只是拿來篩本科非本科的(?)，接著就是Phone Interview，當時的校招可以排志願序，我原本想去的是 Security 或者 Deployment Profile，但我在面試過程中，發現問題大多會跟 Troubleshooting 相關，因此Security Fail了，然後Deployment 進到最後的loop 的最後一關技術關也被問爆，後來轉面 DMS(Developer and Mobile Services) ，雖然是自己完全不太熟悉的領域，但好險最後通過面試了。...</div></div></div></a><a class="pagination-related" href="/posts/dce71546.html" title="DevOps技能樹知識整理 |【筆記目錄】"><img class="cover" src="/img/devops/cover3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2060-11-05</div><div class="info-item-2">DevOps技能樹知識整理 |【筆記目錄】</div></div><div class="info-2"><div class="info-item-1">前言這裡紀錄 DevOps 面試常見的知識點，主要是參考了這個 github repository: DevOps Exercises 和 ByteByteGo 的 GitHub Repo 所做的筆記整理  可能會花很久時間才能夠全部整理完成~  DevOps GeneralPython Basic Data Types OOP &#x2F; Class Raise Exceptions Regex Async File Manipulation OS lambda decorator Flask   文章： Python for DevOps |【DevOps技能樹】  Networking TCP&#x2F;UDP OSI Model CIDR Mac Addr. CSMA&#x2F;CD NAT DNS ICMP TLS&#x2F;SSL Handshake Route Table ARP DHCP VLAN  SDN  Configuration ..etc  Linux Basic Commands Filesystem Hierarchy Standard Permi...</div></div></div></a><a class="pagination-related" href="/posts/c79cef2b.html" title="Lambda 基本認識 feat.容器重用小實驗"><img class="cover" src="/img/PEPE1.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-16</div><div class="info-item-2">Lambda 基本認識 feat.容器重用小實驗</div></div><div class="info-2"><div class="info-item-1">前言首先，為什麼談到無伺服器總是會有人提到 Lambda ? 以下就開始來介紹這個服務 FaaS (Function as a Service)一旦談到無伺服器運算，就會提到他的核心概念，功能即服務(Function as a Service) ，這裡引用維基百科對於 FaaS 的解釋  FaaS 是雲端運算的一種模型。以平台即服務（PaaS）為基礎，無伺服器運算提供一個微型的架構，終端客戶不需要部署、配置或管理伺服器服務，程式碼運行所需要的伺服器服務皆由雲端平台來提供。  沒錯，這個概念的核心就是讓使用者專注在設計產品或業務邏輯，而不需費心在部署配置或是設定伺服器。 而最早實踐這個概念並推出服務的，就是 AWS 在 2014 年推出的 Lambda 服務。（當然後續也有 Microsoft 的 Azure Function） Lambda 函數 Lambda 在高可用性的運算基礎設施上執行您的程式碼，並執行所有運算資源的管理，包括伺服器與作業系統維護、容量佈建與自動擴展以及記錄。使用 Lambda，您唯一需要做的就是在 Lambda 支援的其中一種語言執行期中提供您的程式碼 [...</div></div></div></a><a class="pagination-related" href="/posts/421a206a.html" title="建立 Lambda 函數 URL 的步驟"><img class="cover" src="/img/AWS/Lambda_URL/cover.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-03</div><div class="info-item-2">建立 Lambda 函數 URL 的步驟</div></div><div class="info-2"><div class="info-item-1">甚麼是 Lambda URL ? 官方定義: 函數 URL 是 Lambda 函數專用的 HTTP(S) 端點。您可以透過 Lambda 主控台或 Lambda API 建立及設定函數 URL。當您建立函數 URL 時，Lambda 會自動為您產生不重複的 URL 端點。函數 URL 一旦建立，其 URL 端點便永遠不會變更。  函數 URL 端點的格式如下： 1https://&lt;url-id&gt;.lambda-url.&lt;region&gt;.on.aws  要特別注意的是，某些region並不支援使用 function URL，這時可能就要用老方法: API Gateway + Lambda Integration 存取控制在建立 function URL 的時候可以透過 AuthType 參數，來決定 Lambda 如何對 funcion URL 的請求執行身分驗證或授權 AuthType 選項:  AWS_IAM : 　如果想讓已完成身分驗證的使用者或Role透過function URL 呼叫你的函數，就要選 AWS_IAM NONE:   Lambda 不...</div></div></div></a><a class="pagination-related" href="/posts/aws-iot-device-shadow.html" title="Hands-On Practice: AWS IoT Device Shadow"><img class="cover" src="/img/pepe_shadow.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-08</div><div class="info-item-2">Hands-On Practice: AWS IoT Device Shadow</div></div><div class="info-2"><div class="info-item-1">Intro - What is AWS IoT Device Shadow?In real world, sometime it is difficult to get the actual device state in real time in such IoT scenarios. A device shadow can overcome this challenge, Device Shadow can consider a virtual  virtual representation of a device which managed by the IoT Things resource created in AWS IoT Core.  The Shadow document is a JSON or a JavaScript notation doc that is used to store and retrieve the current state information for a device. You can use the shadow to get...</div></div></div></a><a class="pagination-related" href="/posts/f40d2e89.html" title="Lambda_layer 概念和實作"><img class="cover" src="/img/pepe3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-20</div><div class="info-item-2">Lambda_layer 概念和實作</div></div><div class="info-2"><div class="info-item-1">前言針對 Lambda 設定，絕大多數人一定碰過 ImportModuleError  所以各位可以跟著以下的情境，開一個一樣的 Lambda 環境逐步操作。 情境 Region: IAD(us-east-1) Runtime: Python3.11 Lambda Name: “ITHomeLambdaFunction” Lambda code1234567891011import json requestsdef lambda_handler(event, context):    # TODO implement    x = requests.get(&#x27;https://www.ntust.edu.tw/&#x27;)    print(x.text)    return &#123;        &#x27;statusCode&#x27;: 200,        &#x27;body&#x27;: json.dumps(&#x27;Hello from Lambda!&#x27;)    &#125;  [Error]: Runtime.ImportModu...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 評論</span></div></div><div class="comment-wrap"><div><div id="utterances-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/me.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Kevin Liu</div><div class="author-info-description">👍👍👍👍👍</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">183</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">119</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/leozzmc"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/leozzmc" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:zzmczzmczzmc870125@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #e0ad5a;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/kevin-liu087" target="_blank" title="LinkedIn"><i class="fa-brands fa-linkedin" style="color: #0373fc;"></i></a><a class="social-icon" href="https://www.youtube.com/channel/UC2AU_vpxPu0oKcgZl3UJSNg" target="_blank" title="Youtube"><i class="fa-brands fa-youtube" style="color: #dc1e1e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">不定期更新中</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目錄</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Amazon-MQ"><span class="toc-number">1.</span> <span class="toc-text">Amazon MQ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ActiveMQ-%E4%BB%A3%E7%90%86%E7%B6%B2%E8%B7%AF%EF%BC%88Network-of-brokers%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">ActiveMQ 代理網路（Network of brokers）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Steps"><span class="toc-number">3.</span> <span class="toc-text">Steps</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#conduitSubscriptions-%E5%B1%AC%E6%80%A7"><span class="toc-number">3.1.</span> <span class="toc-text">conduitSubscriptions 屬性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%83%E8%80%83"><span class="toc-number">4.</span> <span class="toc-text">參考</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/d0fc136d.html" title="LeetCode 刷題知識總整理">LeetCode 刷題知識總整理</a><time datetime="2100-11-29T01:08:02.000Z" title="發表於 2100-11-29 09:08:02">2100-11-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dce71546.html" title="DevOps技能樹知識整理 |【筆記目錄】"><img src="/img/devops/cover3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DevOps技能樹知識整理 |【筆記目錄】"/></a><div class="content"><a class="title" href="/posts/dce71546.html" title="DevOps技能樹知識整理 |【筆記目錄】">DevOps技能樹知識整理 |【筆記目錄】</a><time datetime="2060-11-05T13:45:50.000Z" title="發表於 2060-11-05 21:45:50">2060-11-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/22911275.html" title="Git for DevOps 筆記 |【DevOps技能樹】"><img src="/img/devops/git/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git for DevOps 筆記 |【DevOps技能樹】"/></a><div class="content"><a class="title" href="/posts/22911275.html" title="Git for DevOps 筆記 |【DevOps技能樹】">Git for DevOps 筆記 |【DevOps技能樹】</a><time datetime="2025-11-11T03:45:46.000Z" title="發表於 2025-11-11 11:45:46">2025-11-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/85addf17.html" title="合法括號字串 | Medium | LeetCode#678. Valid Parenthesis String"><img src="/img/LeetCode/678/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="合法括號字串 | Medium | LeetCode#678. Valid Parenthesis String"/></a><div class="content"><a class="title" href="/posts/85addf17.html" title="合法括號字串 | Medium | LeetCode#678. Valid Parenthesis String">合法括號字串 | Medium | LeetCode#678. Valid Parenthesis String</a><time datetime="2025-10-26T07:05:24.000Z" title="發表於 2025-10-26 15:05:24">2025-10-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8a835d3b.html" title="Pow(x, n) | Medium | LeetCode#50. Pow(x, n)"><img src="/img/LeetCode/50/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Pow(x, n) | Medium | LeetCode#50. Pow(x, n)"/></a><div class="content"><a class="title" href="/posts/8a835d3b.html" title="Pow(x, n) | Medium | LeetCode#50. Pow(x, n)">Pow(x, n) | Medium | LeetCode#50. Pow(x, n)</a><time datetime="2025-10-23T06:03:36.000Z" title="發表於 2025-10-23 14:03:36">2025-10-23</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2019 - 2025 By Kevin Liu</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 6.3.0</a><span class="footer-separator">|</span><span>主題 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="閱讀模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日夜模式切換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目錄"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往評論"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到頂端"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        loader: {
          load: [
            // Four font extension packages (optional)
            //- '[tex]/bbm',
            //- '[tex]/bboldx',
            //- '[tex]/dsfont',
            '[tex]/mhchem'
          ],
          paths: {
            'mathjax-newcm': '[mathjax]/../@mathjax/mathjax-newcm-font',

            //- // Four font extension packages (optional)
            //- 'mathjax-bbm-extension': '[mathjax]/../@mathjax/mathjax-bbm-font-extension',
            //- 'mathjax-bboldx-extension': '[mathjax]/../@mathjax/mathjax-bboldx-font-extension',
            //- 'mathjax-dsfont-extension': '[mathjax]/../@mathjax/mathjax-dsfont-font-extension',
            'mathjax-mhchem-extension': '[mathjax]/../@mathjax/mathjax-mhchem-font-extension'
          }
        },
        output: {
          font: 'mathjax-newcm',
        },
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
          packages: {
            '[+]': [
              'mhchem'
            ]
          }
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          menuOptions: {
            settings: {
              enrich: false  // Turn off Braille and voice narration text automatic generation
            }
          },
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@4.0.0/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'dark'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.0/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null
  const getUtterancesTheme = theme => theme === 'dark' ? 'photon-dark' : 'github-light'

  const loadUtterances = (el = document, key) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyUtterances = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const config = {
      src: 'https://utteranc.es/client.js',
      repo: 'leozzmc/Blog_Reply',
      theme: getUtterancesTheme(document.documentElement.getAttribute('data-theme')),
      crossorigin: 'anonymous',
      async: true,
      ...option,
      'issue-term': isShuoshuo ? key : (option && option['issue-term']) || 'pathname'
    }

    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => ele.setAttribute(key, value))
    el.querySelector('#utterances-wrap').appendChild(ele)
  }

  const changeUtterancesTheme = theme => {
    const iframe = document.querySelector('#utterances-wrap iframe')
    if (iframe) {
      const message = {
        type: 'set-theme',
        theme: getUtterancesTheme(theme)
      };
      iframe.contentWindow.postMessage(message, 'https://utteranc.es')
    }
  }

  btf.addGlobalFn('themeChange', changeUtterancesTheme, 'utterances')

  if (isShuoshuo) {
    'Utterances' === 'Utterances'
      ? window.shuoshuoComment = { loadComment: loadUtterances }
      : window.loadOtherComment = loadUtterances
    return
  }
  
  if ('Utterances' === 'Utterances' || !false) {
    if (false) btf.loadComment(document.getElementById('utterances-wrap'), loadUtterances)
    else loadUtterances()
  } else {
    window.loadOtherComment = loadUtterances
  }
})()</script></div><script data-pjax src="/self/btf.js"></script><script data-pjax src="/self/tw_en.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script data-pjax src="/self/calendar.js"></script><script data-pjax src="/self/languages.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/click-show-text.min.js" data-mobile="false" data-text="👍,👾,💊,🧪,👁️" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜尋</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  資料載入中</span></div><div class="local-search-input"><input placeholder="搜尋文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.1"></script></div></div></body></html>